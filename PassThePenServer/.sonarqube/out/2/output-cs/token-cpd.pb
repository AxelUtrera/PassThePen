Ã
NC:\Users\DELL\Documents\GitFlow\PassThePen\PassThePenServer\Logic\ChatLogic.cs
	namespace 	
Logic
 
{ 
public		 

class		 
	ChatLogic		 
{

 
public 
string 
BuildMessage "
(" #
string# )
senderUsername* 8
,8 9
string: @
messageA H
)H I
{ 	
string 
hour 
= 
DateTime "
." #
Now# &
.& '
ToShortTimeString' 8
(8 9
)9 :
;: ;
string 
completeMessage "
=# $
hour% )
+* +
$str, 1
+2 3
senderUsername4 B
+C D
$strE I
+J K
messageL S
;S T
return 
completeMessage "
;" #
} 	
} 
} í
OC:\Users\DELL\Documents\GitFlow\PassThePen\PassThePenServer\Logic\Encription.cs
	namespace 	
Logic
 
{		 
public

 

static

 
class

 

Encription

 "
{ 
public 
static 
string 

ToSHA2Hash '
(' (
String( .
input/ 4
)4 5
{ 	
using 
( 
SHA256 

sha256hash $
=% &
SHA256' -
.- .
Create. 4
(4 5
)5 6
)6 7
{ 
byte 
[ 
] 
bytes 
= 

sha256hash )
.) *
ComputeHash* 5
(5 6
Encoding6 >
.> ?
UTF8? C
.C D
GetBytesD L
(L M
inputM R
)R S
)S T
;T U
StringBuilder 
builder %
=& '
new( +
StringBuilder, 9
(9 :
): ;
;; <
for 
( 
int 
i 
= 
$num 
; 
i  !
<" #
bytes$ )
.) *
Length* 0
;0 1
i2 3
++3 5
)5 6
{ 
builder 
. 
Append "
(" #
bytes# (
[( )
i) *
]* +
.+ ,
ToString, 4
(4 5
$str5 9
)9 :
): ;
;; <
} 
return 
builder 
. 
ToString '
(' (
)( )
;) *
} 
} 	
} 
} ÑB
XC:\Users\DELL\Documents\GitFlow\PassThePen\PassThePenServer\Logic\FriendRequestsLogic.cs
	namespace

 	
Logic


 
{ 
public 

class 
FriendRequestsLogic $
{ 
public 
int 
AcceptFriendRequest &
(& '
Domain' -
.- .
FriendRequest. ;
friendRequest< I
)I J
{ 	
int 
operationResult 
=  !
$num" %
;% &
using 
( 
var 
context 
=  
new! $
passthepenEntities% 7
(7 8
)8 9
)9 :
{ 
var +
registerFriendApplicantToPlayer 3
=4 5
context6 =
.= >
Friends> E
.E F
AddF I
(I J
newJ M

DataAccessN X
.X Y
FriendsY `
(` a
)a b
{ 
usernamePlayer "
=# $
friendRequest% 2
.2 3
usernamePlayer3 A
,A B
friendUsername "
=# $
friendRequest% 2
.2 3
friendUsername3 A
} 
) 
; 
context 
. 
Friends 
.  
Add  #
(# $
new$ '

DataAccess( 2
.2 3
Friends3 :
(: ;
); <
{ 
usernamePlayer "
=# $
friendRequest% 2
.2 3
friendUsername3 A
,A B
friendUsername   "
=  # $
friendRequest  % 2
.  2 3
usernamePlayer  3 A
}!! 
)!! 
;!! 
context## 
.## 
SaveChanges## #
(### $
)##$ %
;##% &
int%% 
statusFriendRequest%% '
=%%( )
DeleteFriendRequest%%* =
(%%= >
friendRequest%%> K
)%%K L
;%%L M
if'' 
('' +
registerFriendApplicantToPlayer'' 3
!=''4 6
null''7 ;
&&''< >
statusFriendRequest''? R
==''S U
$num''V Y
)''Y Z
{(( 
operationResult)) #
=))$ %
$num))& )
;))) *
}** 
}-- 
return// 
operationResult// "
;//" #
}00 	
public33 
int33 
DeleteFriendRequest33 &
(33& '
Domain33' -
.33- .
FriendRequest33. ;
friendRequest33< I
)33I J
{44 	
int55 
operationResult55 
=55  !
$num55" %
;55% &
using77 
(77 
var77 
context77 
=77  
new77! $
passthepenEntities77% 7
(777 8
)778 9
)779 :
{88 
var99 #
friendRequestInDataBase99 +
=99, -
context99. 5
.995 6
FriendRequest996 C
.99C D
Where99D I
(99I J
u99J K
=>99L N
u99O P
.99P Q
	idRequest99Q Z
==99[ ]
friendRequest99^ k
.99k l
	idRequest99l u
)99u v
.99v w
First99w |
(99| }
)99} ~
;99~ 
if;; 
(;; #
friendRequestInDataBase;; +
!=;;, .
null;;/ 3
);;3 4
{<< 
context== 
.== 
FriendRequest== )
.==) *
Remove==* 0
(==0 1#
friendRequestInDataBase==1 H
)==H I
;==I J
context>> 
.>> 
SaveChanges>> '
(>>' (
)>>( )
;>>) *
operationResult?? #
=??$ %
$num??& )
;??) *
}@@ 
}AA 
returnCC 
operationResultCC "
;CC" #
}DD 	
publicGG 
ListGG 
<GG 
DomainGG 
.GG 
FriendRequestGG (
>GG( )%
GetFriendRequestsOfPlayerGG* C
(GGC D
stringGGD J
usernameGGK S
)GGS T
{HH 	
ListII 
<II 
DomainII 
.II 
FriendRequestII %
>II% &
friendRequestListII' 8
=II9 :
newII; >
ListII? C
<IIC D
DomainIID J
.IIJ K
FriendRequestIIK X
>IIX Y
(IIY Z
)IIZ [
;II[ \
usingKK 
(KK 
varKK 
contextKK 
=KK  
newKK! $
passthepenEntitiesKK% 7
(KK7 8
)KK8 9
)KK9 :
{LL 
varMM 
listRequestsMM  
=MM! "
contextMM# *
.MM* +
FriendRequestMM+ 8
.NN# $
WhereNN$ )
(NN) *
bNN* +
=>NN, .
bNN/ 0
.NN0 1
usernamePlayerNN1 ?
.NN? @
EqualsNN@ F
(NNF G
usernameNNG O
)NNO P
)NNP Q
.OO# $
ToListOO$ *
(OO* +
)OO+ ,
;OO, -
foreachQQ 
(QQ 

DataAccessQQ #
.QQ# $
FriendRequestQQ$ 1
requestQQ2 9
inQQ: <
listRequestsQQ= I
)QQI J
{RR 
DomainSS 
.SS 
FriendRequestSS (
friendRequestSS) 6
=SS7 8
newSS9 <
DomainSS= C
.SSC D
FriendRequestSSD Q
{TT 
	idRequestUU !
=UU" #
requestUU$ +
.UU+ ,
	idRequestUU, 5
,UU5 6
usernamePlayerVV &
=VV' (
requestVV) 0
.VV0 1
usernamePlayerVV1 ?
,VV? @
friendUsernameWW &
=WW' (
requestWW) 0
.WW0 1
friendUsernameWW1 ?
,WW? @
}XX 
;XX 
friendRequestListZZ %
.ZZ% &
AddZZ& )
(ZZ) *
friendRequestZZ* 7
)ZZ7 8
;ZZ8 9
}[[ 
return\\ 
friendRequestList\\ (
;\\( )
}]] 
}__ 	
publicaa 
intaa 
SendFriendRequestsaa %
(aa% &
Domainaa& ,
.aa, -
FriendRequestaa- :
friendRequestsaa; I
)aaI J
{bb 	
intcc 
operationCodecc 
=cc 
$numcc  #
;cc# $

DataAccessee 
.ee 
FriendRequestee $#
dataAccesFriendRequestsee% <
=ee= >-
!ConvertToDataAccessFriendRequestsee? `
(ee` a
friendRequestseea o
)eeo p
;eep q
usinggg 
(gg 
vargg 
contextgg 
=gg  
newgg! $
passthepenEntitiesgg% 7
(gg7 8
)gg8 9
)gg9 :
{hh 
varii !
friendRequestDataBaseii )
=ii* +
contextii, 3
.ii3 4
FriendRequestii4 A
.iiA B
AddiiB E
(iiE F#
dataAccesFriendRequestsiiF ]
)ii] ^
;ii^ _
contextjj 
.jj 
SaveChangesjj #
(jj# $
)jj$ %
;jj% &
ifll 
(ll !
friendRequestDataBasell )
!=ll* ,
nullll- 1
)ll1 2
{mm 
operationCodenn !
=nn" #
$numnn$ '
;nn' (
}oo 
}pp 
returnqq 
operationCodeqq  
;qq  !
}rr 	
privatett 

DataAccesstt 
.tt 
FriendRequesttt (-
!ConvertToDataAccessFriendRequeststt) J
(ttJ K
DomainttK Q
.ttQ R
FriendRequestttR _ 
domainFriendRequeststt` t
)ttt u
{uu 	
returnvv 
newvv 

DataAccessvv !
.vv! "
FriendRequestvv" /
(vv/ 0
)vv0 1
{ww 
usernamePlayerxx 
=xx   
domainFriendRequestsxx! 5
.xx5 6
usernamePlayerxx6 D
,xxD E
friendUsernameyy 
=yy   
domainFriendRequestsyy! 5
.yy5 6
friendUsernameyy6 D
,yyD E
}zz 
;zz 
}|| 	
}}} 
}~~ åñ
PC:\Users\DELL\Documents\GitFlow\PassThePen\PassThePenServer\Logic\PlayerLogic.cs
	namespace		 	
Logic		
 
{

 
public 

class 
PlayerLogic 
{ 
public 
int 
AutenticatePlayer $
($ %
Domain% +
.+ ,
Player, 2
player3 9
)9 :
{ 	
int 

userResult 
= 
$num  
;  !
string 
passwordHash 
=  !

Encription" ,
., -

ToSHA2Hash- 7
(7 8
player8 >
.> ?
password? G
)G H
;H I
using 
( 
var 
dataBase 
=  !
new" %
passthepenEntities& 8
(8 9
)9 :
): ;
{ 
var 
user 
= 
( 
from  
Player! '
in( *
dataBase+ 3
.3 4
Player4 :
where !
Player" (
.( )
username) 1
.1 2
Equals2 8
(8 9
player9 ?
.? @
username@ H
)H I
&& 
Player %
.% &
password& .
.. /
Equals/ 5
(5 6
passwordHash6 B
)B C
select "
Player# )
)) *
.* +
Count+ 0
(0 1
)1 2
;2 3
if 
( 
user 
> 
$num 
) 
{ 

userResult 
=  
$num! $
;$ %
} 
} 
return 

userResult 
; 
} 	
public!! 
int!! 
	AddPlayer!! 
(!! 
Domain!! #
.!!# $
Player!!$ *
player!!+ 1
)!!1 2
{"" 	
int$$ 

statusCode$$ 
=$$ 
$num$$  
;$$  !
using%% 
(%% 
var%% 
dataBase%% 
=%%  !
new%%" %
passthepenEntities%%& 8
(%%8 9
)%%9 :
)%%: ;
{&& 
var'' 
	newPlayer'' 
='' 
dataBase''  (
.''( )
Player'') /
.''/ 0
Add''0 3
(''3 4
new''4 7
Player''8 >
(''> ?
)''? @
{(( 
email)) 
=)) 
player)) "
.))" #
email))# (
,))( )
username** 
=** 
player** %
.**% &
username**& .
,**. /
name++ 
=++ 
player++ !
.++! "
name++" &
,++& '
lastname,, 
=,, 
player,, %
.,,% &
lastname,,& .
,,,. /
password-- 
=-- 

Encription-- )
.--) *

ToSHA2Hash--* 4
(--4 5
player--5 ;
.--; <
password--< D
)--D E
,--E F
profileImage..  
=..! "
player..# )
...) *
profileImage..* 6
}// 
)// 
;// 
dataBase00 
.00 
SaveChanges00 $
(00$ %
)00% &
;00& '
if22 
(22 
	newPlayer22 
!=22  
null22! %
)22% &
{33 

statusCode44 
=44  
$num44! $
;44$ %
}55 
}66 
return77 

statusCode77 
;77 
}88 	
public;; 
int;; 
AutenticateEmail;; #
(;;# $
string;;$ *
email;;+ 0
);;0 1
{<< 	
int== 
emailResult== 
=== 
$num== !
;==! "
using>> 
(>> 
var>> 
dataBase>> 
=>>  !
new>>" %
passthepenEntities>>& 8
(>>8 9
)>>9 :
)>>: ;
{?? 
var@@ 
playerEmail@@ 
=@@  !
(@@" #
from@@# '
Player@@( .
in@@/ 1
dataBase@@2 :
.@@: ;
Player@@; A
whereAA# (
PlayerBB# )
.BB) *
emailBB* /
.BB/ 0
EqualsBB0 6
(BB6 7
emailBB7 <
)BB< =
selectCC# )
PlayerCC* 0
)CC0 1
.CC1 2
CountCC2 7
(CC7 8
)CC8 9
;CC9 :
ifDD 
(DD 
playerEmailDD 
>DD  !
$numDD" #
)DD# $
{EE 
emailResultFF 
=FF  !
$numFF" %
;FF% &
}GG 
}HH 
returnII 
emailResultII 
;II 
}JJ 	
publicMM 
intMM 

FindPlayerMM 
(MM 
stringMM $
usernameMM% -
)MM- .
{NN 	
intOO 
operationResultOO 
=OO  !
$numOO" %
;OO% &
usingQQ 
(QQ 
varQQ 
contextQQ 
=QQ  
newQQ! $
passthepenEntitiesQQ% 7
(QQ7 8
)QQ8 9
)QQ9 :
{RR 
varSS 
	userFoundSS 
=SS 
contextSS  '
.SS' (
PlayerSS( .
.SS. /
FindSS/ 3
(SS3 4
usernameSS4 <
)SS< =
;SS= >
ifUU 
(UU 
	userFoundUU 
!=UU  
nullUU! %
)UU% &
{VV 
operationResultWW #
=WW$ %
$numWW& )
;WW) *
}XX 
}YY 
returnZZ 
operationResultZZ "
;ZZ" #
}[[ 	
public^^ 
Domain^^ 
.^^ 
Player^^ 
ObtainPlayerData^^ -
(^^- .
string^^. 4
username^^5 =
)^^= >
{__ 	
Domain`` 
.`` 
Player`` 

playerSend`` $
=``% &
null``' +
;``+ ,
usingaa 
(aa 
varaa 
dataBaseContextaa &
=aa' (
newaa) ,
passthepenEntitiesaa- ?
(aa? @
)aa@ A
)aaA B
{bb 
Playercc 
playerObtainedcc %
=cc& '
dataBaseContextcc( 7
.cc7 8
Playercc8 >
.cc> ?
Findcc? C
(ccC D
usernameccD L
)ccL M
;ccM N

playerSenddd 
=dd 
newdd  
Domaindd! '
.dd' (
Playerdd( .
(dd. /
)dd/ 0
{ee 
usernameff 
=ff 
playerObtainedff -
.ff- .
usernameff. 6
,ff6 7
namegg 
=gg 
playerObtainedgg )
.gg) *
namegg* .
,gg. /
lastnamehh 
=hh 
playerObtainedhh -
.hh- .
lastnamehh. 6
,hh6 7
emailii 
=ii 
playerObtainedii *
.ii* +
emailii+ 0
,ii0 1
profileImagejj  
=jj! "
playerObtainedjj# 1
.jj1 2
profileImagejj2 >
}kk 
;kk 
}ll 
returnmm 

playerSendmm 
;mm 
}nn 	
publicqq 
intqq 
UpdateDataPlayerqq #
(qq# $
Stringqq$ *
usernameqq+ 3
,qq3 4
Domainqq5 ;
.qq; <
Playerqq< B
playerqqC I
)qqI J
{rr 	
intss 
	stateCodess 
=ss 
$numss 
;ss  
usingtt 
(tt 
vartt 
dataBaseContexttt &
=tt' (
newtt) ,
passthepenEntitiestt- ?
(tt? @
)tt@ A
)ttA B
{uu 
varvv 
updatedPlayervv !
=vv" #
dataBaseContextvv$ 3
.vv3 4
Playervv4 :
.vv: ;
Firstvv; @
(vv@ A
uvvA B
=>vvC E
uvvF G
.vvG H
usernamevvH P
==vvQ S
usernamevvT \
)vv\ ]
;vv] ^
updatedPlayerww 
.ww 
nameww "
=ww# $
playerww% +
.ww+ ,
nameww, 0
;ww0 1
updatedPlayerxx 
.xx 
lastnamexx &
=xx' (
playerxx) /
.xx/ 0
lastnamexx0 8
;xx8 9
updatedPlayeryy 
.yy 
emailyy #
=yy$ %
playeryy& ,
.yy, -
emailyy- 2
;yy2 3
updatedPlayerzz 
.zz 
profileImagezz *
=zz+ ,
playerzz- 3
.zz3 4
profileImagezz4 @
;zz@ A
int{{ 
returnValue{{ 
={{  !
dataBaseContext{{" 1
.{{1 2
SaveChanges{{2 =
({{= >
){{> ?
;{{? @
if|| 
(|| 
returnValue|| 
>||  !
$num||" #
)||# $
{}} 
	stateCode~~ 
=~~ 
$num~~  #
;~~# $
} 
}
ÄÄ 
return
ÅÅ 
	stateCode
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
public
ÖÖ 
int
ÖÖ 
UpdatePassword
ÖÖ !
(
ÖÖ! "
string
ÖÖ" (
username
ÖÖ) 1
,
ÖÖ1 2
string
ÖÖ3 9
password
ÖÖ: B
)
ÖÖB C
{
ÜÜ 	
int
áá 
	stateCode
áá 
=
áá 
$num
áá 
;
áá  
string
àà 
encriptedPassword
àà $
=
àà% &

Encription
àà' 1
.
àà1 2

ToSHA2Hash
àà2 <
(
àà< =
password
àà= E
)
ààE F
;
ààF G
using
ââ 
(
ââ 
var
ââ 
dataBaseContext
ââ &
=
ââ' (
new
ââ) , 
passthepenEntities
ââ- ?
(
ââ? @
)
ââ@ A
)
ââA B
{
ää 
var
ãã 
updatedPassword
ãã #
=
ãã$ %
dataBaseContext
ãã& 5
.
ãã5 6
Player
ãã6 <
.
ãã< =
First
ãã= B
(
ããB C
u
ããC D
=>
ããE G
u
ããH I
.
ããI J
username
ããJ R
==
ããS U
username
ããV ^
)
ãã^ _
;
ãã_ `
updatedPassword
åå 
.
åå  
password
åå  (
=
åå) *
encriptedPassword
åå+ <
;
åå< =
int
çç 
returnValue
çç 
=
çç  !
dataBaseContext
çç" 1
.
çç1 2
SaveChanges
çç2 =
(
çç= >
)
çç> ?
;
çç? @
if
éé 
(
éé 
returnValue
éé 
>
éé  !
$num
éé" #
)
éé# $
{
èè 
	stateCode
êê 
=
êê 
$num
êê  #
;
êê# $
}
ëë 
}
íí 
return
ìì 
	stateCode
ìì 
;
ìì 
}
îî 	
public
óó 
int
óó !
UpdatePasswordEmail
óó &
(
óó& '
string
óó' -
email
óó. 3
,
óó3 4
string
óó5 ;
password
óó< D
)
óóD E
{
òò 	
int
ôô 
result
ôô 
=
ôô 
$num
ôô 
;
ôô 
string
öö 
encriptedPassword
öö $
=
öö% &

Encription
öö' 1
.
öö1 2

ToSHA2Hash
öö2 <
(
öö< =
password
öö= E
)
ööE F
;
ööF G
using
õõ 
(
õõ 
var
õõ 
dataBaseContext
õõ &
=
õõ' (
new
õõ) , 
passthepenEntities
õõ- ?
(
õõ? @
)
õõ@ A
)
õõA B
{
úú 
var
ùù !
updatePasswordEmail
ùù '
=
ùù( )
dataBaseContext
ùù* 9
.
ùù9 :
Player
ùù: @
.
ùù@ A
First
ùùA F
(
ùùF G
e
ùùG H
=>
ùùI K
e
ùùL M
.
ùùM N
email
ùùN S
==
ùùT V
email
ùùW \
)
ùù\ ]
;
ùù] ^!
updatePasswordEmail
ûû #
.
ûû# $
password
ûû$ ,
=
ûû- .
encriptedPassword
ûû/ @
;
ûû@ A
int
üü 
returnValue
üü 
=
üü  !
dataBaseContext
üü" 1
.
üü1 2
SaveChanges
üü2 =
(
üü= >
)
üü> ?
;
üü? @
if
†† 
(
†† 
returnValue
†† 
>
††  !
$num
††" #
)
††# $
{
°° 
result
¢¢ 
=
¢¢ 
$num
¢¢  
;
¢¢  !
}
££ 
}
§§ 
return
•• 
result
•• 
;
•• 
}
¶¶ 	
public
©© 
List
©© 
<
©© 
Domain
©© 
.
©© 
Friends
©© "
>
©©" #
RecoverFriends
©©$ 2
(
©©2 3
string
©©3 9
username
©©: B
)
©©B C
{
™™ 	
List
´´ 
<
´´ 
Domain
´´ 
.
´´ 
Friends
´´ 
>
´´  
friendsList
´´! ,
=
´´- .
new
´´/ 2
List
´´3 7
<
´´7 8
Domain
´´8 >
.
´´> ?
Friends
´´? F
>
´´F G
(
´´G H
)
´´H I
;
´´I J
using
¨¨ 
(
¨¨ 
var
¨¨ 
dataBaseContext
¨¨ &
=
¨¨' (
new
¨¨) , 
passthepenEntities
¨¨- ?
(
¨¨? @
)
¨¨@ A
)
¨¨A B
{
≠≠ 
try
ÆÆ 
{
ØØ 
var
∞∞ 
friends
∞∞ 
=
∞∞  !
(
∞∞" #
from
∞∞# '
Friends
∞∞( /
in
∞∞0 2
dataBaseContext
∞∞3 B
.
∞∞B C
Friends
∞∞C J
where
±±# (
Friends
≤≤# *
.
≤≤* +
usernamePlayer
≤≤+ 9
==
≤≤: <
username
≤≤= E
select
≥≥# )
Friends
≥≥* 1
)
≥≥1 2
.
≥≥2 3
ToList
≥≥3 9
(
≥≥9 :
)
≥≥: ;
;
≥≥; <
for
¥¥ 
(
¥¥ 
int
¥¥ 
index
¥¥ "
=
¥¥# $
$num
¥¥% &
;
¥¥& '
index
¥¥( -
<
¥¥. /
friends
¥¥0 7
.
¥¥7 8
Count
¥¥8 =
;
¥¥= >
index
¥¥? D
++
¥¥D F
)
¥¥F G
{
µµ 
Domain
∂∂ 
.
∂∂ 
Friends
∂∂ &
	newFriend
∂∂' 0
=
∂∂1 2
new
∂∂3 6
Domain
∂∂7 =
.
∂∂= >
Friends
∂∂> E
(
∂∂E F
)
∂∂F G
;
∂∂G H
	newFriend
∑∑ !
.
∑∑! "
idPlayerFriends
∑∑" 1
=
∑∑2 3
friends
∑∑4 ;
[
∑∑; <
index
∑∑< A
]
∑∑A B
.
∑∑B C
idFriend
∑∑C K
;
∑∑K L
	newFriend
∏∏ !
.
∏∏! "
username
∏∏" *
=
∏∏+ ,
friends
∏∏- 4
[
∏∏4 5
index
∏∏5 :
]
∏∏: ;
.
∏∏; <
usernamePlayer
∏∏< J
;
∏∏J K
	newFriend
ππ !
.
ππ! "
friendUsername
ππ" 0
=
ππ1 2
friends
ππ3 :
[
ππ: ;
index
ππ; @
]
ππ@ A
.
ππA B
friendUsername
ππB P
;
ππP Q
friendsList
∫∫ #
.
∫∫# $
Add
∫∫$ '
(
∫∫' (
	newFriend
∫∫( 1
)
∫∫1 2
;
∫∫2 3
}
ªª 
}
ºº 
catch
ΩΩ 
(
ΩΩ 
	Exception
ΩΩ  
e
ΩΩ! "
)
ΩΩ" #
{
ææ 
Console
øø 
.
øø 
	WriteLine
øø %
(
øø% &
e
øø& '
.
øø' (

StackTrace
øø( 2
)
øø2 3
;
øø3 4
}
¿¿ 
}
¡¡ 
return
¬¬ 
friendsList
¬¬ 
;
¬¬ 
}
√√ 	
public
∆∆ 
int
∆∆ 
DeleteFriend
∆∆ 
(
∆∆  
Domain
∆∆  &
.
∆∆& '
Friends
∆∆' .
friend
∆∆/ 5
)
∆∆5 6
{
«« 	
int
»» 
operationResult
»» 
=
»»  !
$num
»»" %
;
»»% &
using
   
(
   
var
   
context
   
=
    
new
  ! $ 
passthepenEntities
  % 7
(
  7 8
)
  8 9
)
  9 :
{
ÀÀ 
var
ÃÃ 
friendToDeleted
ÃÃ #
=
ÃÃ$ %
context
ÃÃ& -
.
ÃÃ- .
Friends
ÃÃ. 5
.
ÃÃ5 6
Where
ÃÃ6 ;
(
ÃÃ; <
u
ÃÃ< =
=>
ÃÃ> @
u
ÃÃA B
.
ÃÃB C
usernamePlayer
ÃÃC Q
.
ÃÃQ R
Equals
ÃÃR X
(
ÃÃX Y
friend
ÃÃY _
.
ÃÃ_ `
username
ÃÃ` h
)
ÃÃh i
&&
ÃÃj l
u
ÃÃm n
.
ÃÃn o
friendUsername
ÃÃo }
.
ÃÃ} ~
EqualsÃÃ~ Ñ
(ÃÃÑ Ö
friendÃÃÖ ã
.ÃÃã å
friendUsernameÃÃå ö
)ÃÃö õ
)ÃÃõ ú
.ÃÃú ù
FirstÃÃù ¢
(ÃÃ¢ £
)ÃÃ£ §
;ÃÃ§ •
var
ÕÕ 
deletedToFriend
ÕÕ #
=
ÕÕ$ %
context
ÕÕ& -
.
ÕÕ- .
Friends
ÕÕ. 5
.
ÕÕ5 6
Where
ÕÕ6 ;
(
ÕÕ; <
u
ÕÕ< =
=>
ÕÕ> @
u
ÕÕA B
.
ÕÕB C
usernamePlayer
ÕÕC Q
.
ÕÕQ R
Equals
ÕÕR X
(
ÕÕX Y
friend
ÕÕY _
.
ÕÕ_ `
friendUsername
ÕÕ` n
)
ÕÕn o
&&
ÕÕp r
u
ÕÕs t
.
ÕÕt u
friendUsernameÕÕu É
.ÕÕÉ Ñ
EqualsÕÕÑ ä
(ÕÕä ã
friendÕÕã ë
.ÕÕë í
usernameÕÕí ö
)ÕÕö õ
)ÕÕõ ú
.ÕÕú ù
FirstÕÕù ¢
(ÕÕ¢ £
)ÕÕ£ §
;ÕÕ§ •
if
œœ 
(
œœ 
friendToDeleted
œœ #
!=
œœ$ &
null
œœ' +
&&
œœ, .
deletedToFriend
œœ/ >
!=
œœ? A
null
œœB F
)
œœF G
{
–– 
context
—— 
.
—— 
Friends
—— #
.
——# $
Remove
——$ *
(
——* +
friendToDeleted
——+ :
)
——: ;
;
——; <
context
““ 
.
““ 
Friends
““ #
.
““# $
Remove
““$ *
(
““* +
deletedToFriend
““+ :
)
““: ;
;
““; <
context
”” 
.
”” 
SaveChanges
”” '
(
””' (
)
””( )
;
””) *
operationResult
‘‘ #
=
‘‘$ %
$num
‘‘& )
;
‘‘) *
}
’’ 
}
÷÷ 
return
ÿÿ 
operationResult
ÿÿ "
;
ÿÿ" #
}
ŸŸ 	
}
‹‹ 
}›› á
\C:\Users\DELL\Documents\GitFlow\PassThePen\PassThePenServer\Logic\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str  
)  !
]! "
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str "
)" #
]# $
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *à
NC:\Users\DELL\Documents\GitFlow\PassThePen\PassThePenServer\Logic\SendEmail.cs
	namespace

 	
Logic


 
{ 
public 

class 
	SendEmail 
{ 
public 
const 
string 
from  
=! "
$str# ;
;; <
public 
const 
string 
displayName '
=( )
$str* 8
;8 9
public 
const 
string 
body  
=! "
$str# >
;> ?
public 
int 
SendNewEmail 
(  
String  &
to' )
,) *
String+ 1
affair2 8
,8 9
int: =
validationCode> L
)L M
{ 	
int 
result 
= 
$num 
; 
try 
{ 
MailMessage 
mailMessage '
=( )
new* -
MailMessage. 9
(9 :
): ;
;; <
mailMessage 
. 
From  
=! "
new# &
MailAddress' 2
(2 3
from3 7
,8 9
displayName: E
)E F
;F G
mailMessage 
. 
To 
. 
Add "
(" #
to# %
)% &
;& '
mailMessage 
. 
Subject #
=$ %
affair& ,
;, -
mailMessage 
. 
Body  
=! "
body# '
+( )
validationCode* 8
;8 9
mailMessage 
. 
BodyEncoding (
=) *
Encoding+ 3
.3 4
UTF84 8
;8 9
mailMessage 
. 

IsBodyHtml &
=' (
true) -
;- .

SmtpClient 
client !
=" #
new$ '

SmtpClient( 2
(2 3
$str3 G
,G H
$numI L
)L M
;M N
client   
.   
Credentials   "
=  # $
new  % (
NetworkCredential  ) :
(  : ;
from  ; ?
,  ? @
$str  A R
)  R S
;  S T
client!! 
.!! 
	EnableSsl!!  
=!!! "
true!!# '
;!!' (
client"" 
."" 
Send"" 
("" 
mailMessage"" '
)""' (
;""( )
}## 
catch$$ 
($$ 
SmtpException$$  
ex$$! #
)$$# $
{%% 
String&& 
message&& 
=&&  
ex&&! #
.&&# $
Message&&$ +
;&&+ ,
result'' 
='' 
$num'' 
;'' 
}(( 
return)) 
result)) 
;)) 
}** 	
}++ 
},, 